<div class="modal-header border-0 pb-0">
	<button type="button" class="btn-close" aria-label="Close" (click)="activeModal.close()"></button>
</div>
<div class="modal-body px-4 pb-4">
	<!-- Header Section -->
	<div class="text-center mb-4">
		<div class="signup-icon mb-3">
			<i class="fas fa-user-plus fa-4x text-success"></i>
		</div>
		<h2 class="fw-bold text-dark mb-2">Create Account</h2>
		<p class="text-muted mb-0">Join SimpleTrack and start tracking your analytics</p>
	</div>

	<!-- Success/Error Messages -->
	<div *ngIf="message" class="alert mb-4 border-0 shadow-sm" [ngClass]="{
		'alert-success bg-success-subtle text-success-emphasis border-success-subtle': message.type === 'success',
		'alert-danger bg-danger-subtle text-danger-emphasis border-danger-subtle': message.type === 'error'
	}" role="alert">
		<i class="fas me-2" [ngClass]="{
			'fa-check-circle': message.type === 'success',
			'fa-exclamation-triangle': message.type === 'error'
		}"></i>
		{{ message.text }}
	</div>

	<form [formGroup]="signupForm" (ngSubmit)="onSubmit()" novalidate>
		<div class="row">
			<div class="col-md-6 mb-3">
				<label for="firstname" class="form-label fw-semibold text-dark">
					<i class="fas fa-user me-2 text-muted"></i>First Name *
				</label>
				<div class="input-group">
					<span class="input-group-text bg-light border-end-0">
						<i class="fas fa-user text-muted"></i>
					</span>
					<input type="text" class="form-control border-start-0 ps-0" id="firstname"
						   formControlName="firstname" placeholder="John"
						   [class.is-invalid]="signupForm.get('firstname')?.invalid && signupForm.get('firstname')?.touched">
				</div>
				<div class="invalid-feedback d-block" *ngIf="signupForm.get('firstname')?.invalid && signupForm.get('firstname')?.touched">
					<i class="fas fa-exclamation-circle me-1"></i>
					First name is required and must be at least 2 characters.
				</div>
			</div>
			<div class="col-md-6 mb-3">
				<label for="lastname" class="form-label fw-semibold text-dark">
					<i class="fas fa-user me-2 text-muted"></i>Last Name
				</label>
				<div class="input-group">
					<span class="input-group-text bg-light border-end-0">
						<i class="fas fa-user text-muted"></i>
					</span>
					<input type="text" class="form-control border-start-0 ps-0" id="lastname"
						   formControlName="lastname" placeholder="Doe"
						   [class.is-invalid]="signupForm.get('lastname')?.invalid && signupForm.get('lastname')?.touched">
				</div>
				<div class="invalid-feedback d-block" *ngIf="signupForm.get('lastname')?.invalid && signupForm.get('lastname')?.touched">
					<i class="fas fa-exclamation-circle me-1"></i>
					Last name must be at least 2 characters if provided.
				</div>
			</div>
		</div>

		<div class="mb-3">
			<label for="signupEmail" class="form-label fw-semibold text-dark">
				<i class="fas fa-envelope me-2 text-muted"></i>Email Address *
			</label>
			<div class="input-group">
				<span class="input-group-text bg-light border-end-0">
					<i class="fas fa-envelope text-muted"></i>
				</span>
				<input type="email" class="form-control border-start-0 ps-0" id="signupEmail"
					   formControlName="email" placeholder="john.doe@example.com"
					   [class.is-invalid]="signupForm.get('email')?.invalid && signupForm.get('email')?.touched">
			</div>
			<div class="invalid-feedback d-block" *ngIf="signupForm.get('email')?.invalid && signupForm.get('email')?.touched">
				<i class="fas fa-exclamation-circle me-1"></i>
				Please enter a valid email address.
			</div>
		</div>

		<div class="mb-3">
			<label for="mobileno" class="form-label fw-semibold text-dark">
				<i class="fas fa-phone me-2 text-muted"></i>Mobile Number
			</label>
			<div class="input-group">
				<span class="input-group-text bg-light border-end-0">
					<i class="fas fa-phone text-muted"></i>
				</span>
				<input type="tel" class="form-control border-start-0 ps-0" id="mobileno"
					   formControlName="mobileno" placeholder="+1234567890"
					   [class.is-invalid]="signupForm.get('mobileno')?.invalid && signupForm.get('mobileno')?.touched">
			</div>
			<div class="invalid-feedback d-block" *ngIf="signupForm.get('mobileno')?.invalid && signupForm.get('mobileno')?.touched">
				<i class="fas fa-exclamation-circle me-1"></i>
				Please enter a valid mobile number if provided.
			</div>
		</div>

		<div class="mb-4">
			<label for="signupPassword" class="form-label fw-semibold text-dark">
				<i class="fas fa-lock me-2 text-muted"></i>Password
			</label>
			<div class="input-group">
				<span class="input-group-text bg-light border-end-0">
					<i class="fas fa-lock text-muted"></i>
				</span>
				<input [type]="showPassword ? 'text' : 'password'" class="form-control border-start-0 ps-0"
					   id="signupPassword" formControlName="password" placeholder="Create a strong password"
					   [class.is-invalid]="signupForm.get('password')?.invalid && signupForm.get('password')?.touched">
				<button type="button" class="btn btn-outline-secondary border-start-0" (click)="togglePasswordVisibility()">
					<i class="fas" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
				</button>
			</div>
			<div class="invalid-feedback d-block" *ngIf="signupForm.get('password')?.invalid && signupForm.get('password')?.touched">
				<i class="fas fa-exclamation-circle me-1"></i>
				Password must be at least 6 characters if provided.
			</div>
			<div class="form-text text-muted mt-1">
				<i class="fas fa-info-circle me-1"></i>
				Password must be at least 6 characters long (optional)
			</div>
		</div>

		<div class="mb-4">
			<label for="confirmPassword" class="form-label fw-semibold text-dark">
				<i class="fas fa-lock me-2 text-muted"></i>Confirm Password
			</label>
			<div class="input-group">
				<span class="input-group-text bg-light border-end-0">
					<i class="fas fa-lock text-muted"></i>
				</span>
				<input [type]="showConfirmPassword ? 'text' : 'password'" class="form-control border-start-0 ps-0"
					   id="confirmPassword" formControlName="confirmPassword" placeholder="Confirm your password"
					   [class.is-invalid]="(signupForm.get('confirmPassword')?.invalid && signupForm.get('confirmPassword')?.touched) || signupForm.hasError('passwordMismatch')">
				<button type="button" class="btn btn-outline-secondary border-start-0" (click)="toggleConfirmPasswordVisibility()">
					<i class="fas" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
				</button>
			</div>
			<div class="invalid-feedback d-block" *ngIf="(signupForm.get('confirmPassword')?.invalid && signupForm.get('confirmPassword')?.touched) || signupForm.hasError('passwordMismatch')">
				<i class="fas fa-exclamation-circle me-1"></i>
				<span *ngIf="signupForm.hasError('passwordMismatch')">Passwords do not match.</span>
				<span *ngIf="signupForm.get('confirmPassword')?.invalid && !signupForm.hasError('passwordMismatch')">Please confirm your password.</span>
			</div>
		</div>

		<!-- Terms and Conditions -->
		<div class="mb-4">
			<div class="form-check">
				<input class="form-check-input" type="checkbox" id="acceptTerms" formControlName="acceptTerms">
				<label class="form-check-label text-muted small" for="acceptTerms">
					I agree to the <a href="#" class="text-decoration-none text-primary">Terms of Service</a> and
					<a href="#" class="text-decoration-none text-primary">Privacy Policy</a>
				</label>
			</div>
			<div class="invalid-feedback d-block" *ngIf="signupForm.get('acceptTerms')?.invalid && signupForm.get('acceptTerms')?.touched">
				<i class="fas fa-exclamation-circle me-1"></i>
				You must accept the terms and conditions.
			</div>
		</div>

		<button type="submit" class="btn btn-success w-100 py-3 fw-semibold mb-3"
				[disabled]="signupForm.get('firstname')?.invalid || signupForm.get('email')?.invalid || signupForm.get('acceptTerms')?.invalid || signupForm.hasError('passwordMismatch') || isLoading" [ngClass]="{'btn-loading': isLoading}">
			<span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status"></span>
			<i class="fas fa-user-plus me-2" *ngIf="!isLoading"></i>
			{{ isLoading ? 'Creating Account...' : 'Create Account' }}
		</button>
	</form>

	<!-- Sign In Link -->
	<div class="text-center">
		<span class="text-muted">Already have an account? </span>
		<a href="#" class="text-decoration-none fw-semibold text-primary" (click)="openLogin()">
			Sign in here
		</a>
	</div>
</div>
